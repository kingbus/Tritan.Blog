<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Excel Reader</title>
    <link rel='stylesheet' type='text/css' href='css/shCoreEmacs.css'>
    <link rel="stylesheet" type="text/css" href="../assets/css/amazeui.css">


    <script type="javascript" src="../assets/js/jquery.min.js">
    </script>

    <script type="javascript" src="../assets/js/amazeui.min.js">
    </script>

</head>
<body>
<div data-am-widget="titlebar"  class="am-titlebar am-titlebar-default">
    <h2 class="am-titlebar-title">Excel Library</h2>
    <nav class="am-titlebar-nav">
        <a href="../myNotes.html" class="">返回</a>
    </nav>
</div>

<div class="page">
    <ol>
        <li>
            <p>
                Open file<br/>
            </p>
            <p>
            <div id="highlighter_137133" class="syntaxhighlighter  csharp"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="csharp plain">Stream&nbsp;fileStream&nbsp;=&nbsp;File.OpenRead(file);</code></div><div class="line number2 index1 alt1"><code class="csharp plain">Workbook&nbsp;book&nbsp;=&nbsp;</code><code class="csharp keyword">new</code>&nbsp;<code class="csharp plain">Workbook();</code></div><div class="line number3 index2 alt2"><code class="csharp plain">book.Open(fileStream);</code></div><div class="line number4 index3 alt1"><code class="csharp plain">Worksheet&nbsp;sheet&nbsp;=&nbsp;book.Worksheets[0];</code></div><div class="line number5 index4 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;</code>&nbsp;</div></div></td></tr></tbody></table></div>
            </p>
        </li>
        <li>
            <p>
                Read cell
            </p>
            <p>
            <div id="highlighter_554331" class="syntaxhighlighter  csharp"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="csharp keyword">int</code>&nbsp;<code class="csharp plain">row&nbsp;=1;</code></div><div class="line number2 index1 alt1"><code class="csharp keyword">int</code>&nbsp;<code class="csharp plain">col&nbsp;=0;</code></div><div class="line number3 index2 alt2"><code class="csharp keyword">string</code>&nbsp;<code class="csharp plain">ID=sheet.Cells[row,col].StringValue;</code></div><div class="line number4 index3 alt1"><code class="csharp plain">Picture&nbsp;pic&nbsp;=sheet.ExtractPicture(row,col);</code></div></div></td></tr></tbody></table></div>
            </p>
        </li>
        <li>
            <p>
                Create workbook
            </p>
            <p>
            <div id="highlighter_508792" class="syntaxhighlighter  csharp"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="csharp keyword">string</code>&nbsp;<code class="csharp plain">file=</code><code class="csharp string">"c:\\test.xls"</code><code class="csharp plain">;</code></div><div class="line number2 index1 alt1"><code class="csharp plain">Workbook&nbsp;workbook&nbsp;=</code><code class="csharp keyword">new</code>&nbsp;<code class="csharp plain">Workbook();</code></div><div class="line number3 index2 alt2"><code class="csharp plain">WorkSheet&nbsp;worksheet=</code><code class="csharp keyword">new</code>&nbsp;<code class="csharp plain">Worksheet(</code><code class="csharp string">"Sheet&nbsp;1"</code><code class="csharp plain">);</code></div><div class="line number4 index3 alt1"><code class="csharp plain">worksheet.Cells[0,1]=</code><code class="csharp keyword">new</code>&nbsp;<code class="csharp plain">Cell(1);</code></div><div class="line number5 index4 alt2"><code class="csharp plain">worksheet.Cells[2,0]=</code><code class="csharp keyword">new</code>&nbsp;<code class="csharp plain">Cell(2.9);</code></div><div class="line number6 index5 alt1"><code class="csharp plain">worksheer.Cells[2,1]=</code><code class="csharp keyword">new</code>&nbsp;<code class="csharp plain">Cell((</code><code class="csharp keyword">decimal</code><code class="csharp plain">)3.33);</code></div><div class="line number7 index6 alt2"><code class="csharp plain">worksheet.Cells[4,5]=</code><code class="csharp keyword">new</code>&nbsp;<code class="csharp plain">Cell(23445.2,</code><code class="csharp string">"#,###.00"</code><code class="csharp plain">);</code></div><div class="line number8 index7 alt1"><code class="csharp plain">worksheet.Cells[3,3]=</code><code class="csharp keyword">new</code>&nbsp;<code class="csharp plain">Cell(</code><code class="csharp string">"Text&nbsp;String"</code><code class="csharp plain">);</code></div><div class="line number9 index8 alt2"><code class="csharp plain">worksheet.Cells[2,2]=</code><code class="csharp keyword">new</code>&nbsp;<code class="csharp plain">Cell(DateTime.Now,</code><code class="csharp string">@"YYYY\-MM\-DD"</code><code class="csharp plain">);</code></div><div class="line number10 index9 alt1"><code class="csharp plain">workbook.Worksheets.Add(worksheet);</code></div><div class="line number11 index10 alt2"><code class="csharp plain">workbook.Save(file);</code></div></div></td></tr></tbody></table></div>
            </p>
        </li>
        <li>
            <p>
                Traverse worksheet
            </p>
            <p>
            <div id="highlighter_619305" class="syntaxhighlighter  csharp"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="csharp keyword">foreach</code><code class="csharp plain">(Pair&lt;Pair&lt;</code><code class="csharp keyword">int</code><code class="csharp plain">,</code><code class="csharp keyword">int</code><code class="csharp plain">&gt;,Cell)&nbsp;cell&nbsp;</code><code class="csharp keyword">in</code>&nbsp;<code class="csharp plain">sheet.Cells)</code></div><div class="line number2 index1 alt1"><code class="csharp plain">{</code></div><div class="line number3 index2 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">dgvCells[cell.Left.Right,cell.Left.Left].Value=cell.Right.Value;</code></div><div class="line number4 index3 alt1"><code class="csharp plain">}</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="csharp keyword">for</code><code class="csharp plain">(</code><code class="csharp keyword">int</code>&nbsp;<code class="csharp plain">rowIndex=sheet.Cells.FirstRowIndex;rowIndex&lt;=sheet.Cells.LastRowIndex;rowIndex++)</code></div><div class="line number7 index6 alt2"><code class="csharp plain">{</code></div><div class="line number8 index7 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Row&nbsp;row=sheet.Cells.GetRow(rowIndex);</code></div><div class="line number9 index8 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp keyword">for</code><code class="csharp plain">(</code><code class="csharp keyword">int</code>&nbsp;<code class="csharp plain">colIndex=row.FirstColIndex;colIndex&lt;=row.LastColIndex;colIndex++)</code></div><div class="line number10 index9 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">{</code></div><div class="line number11 index10 alt2"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">Cell&nbsp;cell=row.GetCell(colIndex);</code></div><div class="line number12 index11 alt1"><code class="csharp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="csharp plain">}</code></div><div class="line number13 index12 alt2"><code class="csharp plain">}</code></div></div></td></tr></tbody></table></div>
            </p>
        </li>
    </ol>
    <p>
        <br/>
    </p>

</div>

<div data-am-widget="gotop" class="am-gotop am-gotop-one" >
    <a href="#top" title="回到顶部">
        <span class="am-gotop-title">回到顶部</span>
        <i class="am-gotop-icon am-icon-chevron-up"></i>
    </a>
</div>

</body>
</html>